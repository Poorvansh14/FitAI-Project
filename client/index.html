<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>FitAI | Home</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="stylesheet"
          href="https://fonts.googleapis.com/css2?family=Rubik:wght@700,500,900&family=Montserrat:wght@400;700&display=swap">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/remixicon@4.1.0/fonts/remixicon.css">
    <link rel="icon" type="image/png" href="/assets/logo.png"/>
    <style>
        :root {
            --primary: #00FFC2;
            --primary-dark: #009e75;
            --accent: #0d0f2b;
            --bg: #f9fafb;
            --text: #19223E;
            --muted: #7b7b8a;
            --feature-bg: rgba(245,245,250,0.92);
            --card-blur: 18px;
            --nav-height: 72px;
            --shadow: 0 8px 24px rgba(0, 28, 80, 0.10);
            --gradient: linear-gradient(120deg,#00ffc2,#6e7fff 80%);
            --transition: .4s cubic-bezier(.53,0,.36,1.6);
            --nav-link-underline: #00ffc2;
        }
        [data-theme=dark] {
            --bg: #181926;
            --text: #f5f7fa;
            --muted: #94a3b8;
            --feature-bg: rgba(31,33,54,0.92);
            --shadow: 0 8px 24px rgba(0, 28, 80, 0.17);
            --nav-link-underline: #6e7fff;
        }
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body {
            font-family: 'Montserrat', system-ui, sans-serif;
            background: var(--bg);
            color: var(--text);
            line-height: 1.7;
            scroll-behavior: smooth;
            transition: background .5s, color .5s;
        }
        a { color: inherit; text-decoration: none; }
        img { max-width: 100%; display: block; border-radius: 16px; }
        .loader-img {
            position:fixed; z-index:11000; left:0; top:0;width:100vw;height:100vh;
            background:var(--bg);
            display: flex;align-items:center;justify-content:center;
            transition: opacity 0.5s;
        }
        .navbar {
            height: var(--nav-height);
            display: flex; align-items:center; justify-content:space-between; flex-wrap:wrap;
            padding: 0 .8rem; background: var(--feature-bg); box-shadow: var(--shadow);
            position: sticky; top: 0; z-index: 900;
            backdrop-filter: blur(8px);
            transition: background .5s, box-shadow .3s;
        }
        .navbar.scrolled { box-shadow: 0 4px 18px rgba(0, 28, 80, 0.15); }
        .navbar.scrolled::after {
            content: '';
            position: absolute; left: 0; right: 0; bottom: -4px; height: 3px;
            background: linear-gradient(90deg, #00ffc2 0%, #6e7fff 100%);
            opacity: 0.6; border-radius: 2px;
            pointer-events: none;
            animation: navGlow .5s;
        }
        @keyframes navGlow { from { opacity: 0; } to { opacity: 0.6; } }
        .logo span {
            font-family: 'Rubik', sans-serif;
            font-size: 2.1rem; font-weight: 900; letter-spacing: -2px;
            color: var(--primary);
            background: var(--gradient);
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            padding: .2em .1em;
            transition: transform 0.2s ease-out;
        }
        .logo:hover span { transform: scale(1.05); }
        nav ul {
            display: flex; gap: 2rem; align-items: center; list-style: none;
            font-size: 1.13rem; font-weight: 500;
        }
        nav ul li a {
            position: relative; padding: .3em .7em; border-radius: 6px;
            transition: color .45s cubic-bezier(.6,1.7,.4,1), 
                        text-shadow .22s cubic-bezier(.53,0,.32,1), transform .2s ease-out;
        }
        nav ul li a.active, nav ul li a:hover {
            color: var(--primary);
            transform: translateY(-2px);
            text-shadow: 0 2px 16px #00ffc264;
        }
        nav ul li a::after {
            content:'';
            position:absolute;bottom:-5px;left:0;width:100%; height: 2px;
            background: var(--nav-link-underline); border-radius: 2px;
            transform: scaleX(0);
            transform-origin: bottom right;
            transition: transform 0.3s cubic-bezier(0.23, 1, 0.32, 1);
        }
        nav ul li a.active::after, nav ul li a:hover::after {
            transform: scaleX(1);
            transform-origin: bottom left;
        }
        .nav-toggle { display:none;cursor:pointer;font-size:2rem;background: none;border:none; transition: color .3s;}
        .nav-toggle:hover { color: var(--primary); }
        @media (max-width:800px) {
            nav ul {
                flex-direction: column; gap:1.1rem;background:var(--feature-bg);position:fixed;right:0;top:var(--nav-height);width:60vw;max-width:340px;padding:2rem 1.5rem 2rem 2rem;box-shadow: -20px 0 40px -13px rgba(0,0,0,0.13);height:100vh;transform:translateX(100%);transition: transform .35s;z-index:100;
                border-left: 1px solid rgba(0,255,194,.1);
            }
            nav ul.open { transform: none;}
            .nav-toggle { display:inline-block;}
        }
        
        /* ðŸ’¡ NEW/UPDATED THEME TOGGLE STYLE */
        .theme-toggle {
            background: radial-gradient(circle, #00ffc2 20%, #6e7fff 90%);
            border: 2px solid rgba(0,255,194,0.3);
            border-radius: 50%;
            width: 44px; /* Increased size */
            height: 44px; /* Increased size */
            display: flex;
            align-items: center;
            justify-content: center;
            margin-left: 0.8rem; /* Keep margin */
            font-size: 1.4rem; /* Increased icon size */
            color: #fff;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 0 15px rgba(0,255,194,0.3);
            position: relative;
        }
        
        .theme-toggle:hover {
            transform: scale(1.1);
            box-shadow: 0 0 25px rgba(0,255,194,0.55);
            /* Removed background/color change on hover for consistency */
        }
        
        .theme-toggle i {
            filter: drop-shadow(0 0 4px rgba(0,255,194,0.7));
        }
        
        /* For dark mode */
        [data-theme="dark"] .theme-toggle {
            background: radial-gradient(circle, #6e7fff 30%, #00ffc2 90%);
            color: #fff;
            box-shadow: 0 0 25px rgba(110,127,255,0.55);
        }

        /* Hover/Active states from diet/workout */
        .theme-toggle:hover {
            transform: scale(1.08);
            /* Resetting hover from old style */
        }
        .theme-toggle:active {
            transform: scale(0.95);
        }
        /* END OF NEW/UPDATED THEME TOGGLE STYLE */

        .hero {
            display:flex;align-items:center;justify-content: space-between; flex-wrap: wrap;
            gap: 2vw; padding: 6vw 5vw 4vw 5vw;
            min-height: 66vh;
            position:relative;
        }
        .hero-content {
            flex:1 1 310px; max-width: 460px;
            animation: fadeInTop .8s;
        }
        .hero-content h1 {
            font-family:'Rubik', sans-serif;font-size:clamp(2.4rem,4.2vw,3.8rem);
            font-weight:900; line-height:1.08;color:var(--primary);
            margin-bottom: .5em; letter-spacing: -.025em;
            text-shadow:0 8px 34px hsla(170,90%,70%,.13);
        }
        .hero-content h1 span {
            background: linear-gradient(87deg,#00ffc2,#6e7fff 60%);
            background-size: 200% 200%;
            animation: gradientMove 2.6s linear infinite;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        @keyframes gradientMove { 0%{background-position:0 50%} 100%{background-position:100% 50%} }
        .hero-content p {
            font-size: 1.28rem; color: var(--muted);
            margin-bottom: 2em; margin-top:.2em;
            max-width: 415px;
        }
        .btn {
            display:inline-block; background: var(--gradient); color:#fff;
            font-family:inherit;font-weight:800;font-size:1.2rem;
            padding: 0.6em 2.1em; border:none;border-radius: 8px;
            box-shadow:0 2px 24px rgba(0,255,194,.11);
            transition: transform 0.18s, box-shadow 0.3s;
            cursor:pointer;
            letter-spacing: .04em;
            position: relative;
            overflow: hidden;
        }
        .btn:hover {
            animation: buttonPulse .4s;
            transform:translateY(-4px) scale(1.06);
            box-shadow:0 4px 32px rgba(14,255,190,.18);
        }
        @keyframes buttonPulse {
            0% { box-shadow: 0 0 0 0 rgba(0,255,194,0.21);}
            70% { box-shadow: 0 0 0 24px rgba(0,255,194,0);}
            100% { box-shadow: 0 2px 24px rgba(0,255,194,.11);}
        }
        .btn .ripple {
            position: absolute;
            border-radius: 50%;
            transform: scale(0);
            animation: ripple 0.6s linear;
            background-color: rgba(255, 255, 255, 0.7);
        }
        @keyframes ripple { to { transform: scale(4); opacity: 0; } }
        .hero-img {
            flex:1 1 280px;
            text-align:center;position:relative;
            z-index:1;
            min-width:260px;
            animation: floatImg 3s infinite alternate cubic-bezier(.44,1.35,.5,1);
        }
        .img-bg-blob {
            position:absolute;top:40px;left:44%;z-index:-1;width:240px;height:260px;
            background:radial-gradient(circle at 60% 10%,#00ffc2 0,#6e7fff 70%,transparent 100%);
            border-radius:70% 40% 33% 67%/56% 46% 54% 44%;
            filter: blur(58px) opacity(0.73);
            animation: fadeInPulse 2.2s;
        }
        .hero-img img { animation: heroFloat 5s ease-in-out infinite alternate; }
        @keyframes heroFloat { from { transform: translateY(0) rotate(-2deg);} to { transform: translateY(-20px) rotate(3deg);} }
        @media (max-width: 900px){ .hero { flex-direction: column-reverse; text-align:center; gap: 2vw;} .img-bg-blob{ left:4%;} }

        .features {
            display: flex; flex-wrap: wrap; justify-content: center;
            gap: 2vw; margin:0 auto; padding:3vw 2vw 4vw 2vw;
            max-width: 1150px;
        }
        .feature {
            background:var(--feature-bg);
            border-radius:19px;
            box-shadow: var(--shadow);
            padding:2.5em 1.8em 2.4em 1.8em;
            margin: .9em;
            min-width: 250px; flex:1 1 295px; max-width: 320px;
            transition:
                transform .35s cubic-bezier(.28,1.25,.59,.77),
                box-shadow .35s,
                background .5s, color .5s;
            position:relative;
            backdrop-filter: blur(var(--card-blur));
            overflow:hidden;
            z-index:0;
            perspective: 600px;
            transform-style: preserve-3d;
            will-change: transform;
        }
        .feature img {
            width: 70px;height: 70px; object-fit:contain; margin-bottom:1.2em; border-radius:50%;background: #e6f8f3;padding:8px;
            box-shadow:0 2px 16px rgba(8,255,170,0.06);
            transition: transform 0.3s ease-in-out;
        }
        .feature h3 {
            font-family: 'Rubik',sans-serif; font-size:1.4rem; font-weight:800;color:var(--primary); margin-bottom:.4em;
            letter-spacing: -.01em;
            transition: color .5s;
        }
        .feature p { color: var(--muted); font-size:1.06em; transition: color .5s; }
        .feature:hover {
            background:var(--primary);
            color: #fff;
            box-shadow: 0 16px 44px rgba(0,255,194,.28), 0 2px 12px #6e7fff18;
        }
        .feature:hover img {transform: scale(1.1);}
        .feature:hover h3, .feature:hover p { color: #fff;}
        [data-theme=dark] .feature:hover {
            box-shadow: 0 0 16px 2px #00ffc2, 0 0 36px 8px #6e7fff50;
            border: 2px solid #00ffc294;
            background: linear-gradient(135deg, #00302A 60%, #0d0f2b 100%);
        }
        footer {
            text-align:center;
            color:var(--muted); background: var(--feature-bg); padding:2.5em 0 2em 0;
            font-size:.97rem; letter-spacing:.01em;border-top:1px solid #eee;box-shadow: var(--shadow);
            margin-top:1vw;
            transition: background .5s, border-color .5s;
        }
        .modal {
            display:none; position:fixed;z-index:1101;left:0;top:0;width:100vw;height:100vh;
            background: rgba(0,0,0, 0.30); backdrop-filter: blur(1.7px);
            align-items:center;justify-content:center;
            animation: fadeInModalBg .55s;
        }
        .modal-content {
            background:rgba(255,255,255,.18);
            border-radius: 25px;
            box-shadow: 0 20px 80px rgba(0,255,194,0.14),0 5px 56px rgba(40,40,105,0.04);
            padding: 2.6em 2.2em 1.7em 2.2em; max-width:370px;width:calc(98vw - 30px);
            margin:2vw auto;display:flex;flex-direction:column;align-items:center;
            animation: modalAppear .7s cubic-bezier(.25,1.4,.65,.94);
            border:1.5px solid var(--primary-dark);
            position:relative;
            color:var(--text);
            transition: background .35s, border-color .35s;
        }
        .modal-content h2 { font-family:'Rubik';font-weight:800;font-size:1.31rem;margin:0 0 .8em 0;color:var(--primary);}
        .modal-content input[type="text"], 
        .modal-content input[type="email"], 
        .modal-content input[type="password"]{
            width:100%;padding:.87em 1.2em;margin-bottom:1.1em;
            border:1.5px solid #c6f4ea25;border-radius:8px;
            background:rgba(240,255,254,.86);color:var(--text);
            font-size:1.09em;transition: border-color .25s, background .25s, color .25s;outline:none;
        }
        /* Dark-mode inputs readable */
        [data-theme="dark"] .modal-content input[type="text"],
        [data-theme="dark"] .modal-content input[type="email"],
        [data-theme="dark"] .modal-content input[type="password"]{
            background:#26283a; color:#f5f7fa; border-color:#3d415f;
        }
        .modal-content input::placeholder{ color:#7b7b8a; }
        [data-theme="dark"] .modal-content input::placeholder{ color:#a7b0c4; }

        .modal-content input:focus {
            box-shadow: 0 2px 18px #00ffc271;
            border-color: #6e7fff;
            background: rgba(240,255,254,1);
        }
        [data-theme="dark"] .modal-content input:focus{
            background:#2e3150;
        }
        .modal-content button { width:100%;font-size:1.05em;padding:.85em;margin-top:.5em;}
        .close {
            position:absolute;top:16px; right:16px;font-size:1.5em;cursor:pointer; color:var(--primary);
            transition:.2s;font-weight:bold;
            transition: color .3s, transform .2s;
        }
        .close:hover { color:#ff002e; transform: rotate(90deg);}
        .small-text {
            margin-top:1em;font-size:0.97em;color:var(--muted);text-align:center;
        }
        .small-text a { color: var(--primary); font-weight: 700; transition: color .3s; }
        .small-text a:hover { color: var(--primary-dark); text-decoration: underline; }
        .password-wrapper{ position:relative;}
        .toggle-eye{
            position:absolute; right:16px;top:50%;transform:translateY(-50%);
            font-size:1.05em; color:var(--muted);cursor:pointer;padding:2px 1px;
            transition: color .3s;
        }
        #loginBtn {
          background: linear-gradient(120deg, #00ffc2, #6e7fff 80%);
          color: #fff;
          font-weight: 700;
          border-radius: 6px;
          padding: 0.45em 1.2em;
          box-shadow: 0 3px 20px rgba(0, 255, 194, 0.2);
          transition: all 0.3s ease-in-out;
        }
        
        #loginBtn:hover {
          box-shadow: 0 6px 28px rgba(0, 255, 194, 0.35);
          transform: translateY(-2px);
        }
        .toggle-eye:hover { color:var(--primary); }
        .modal.show { display:flex;animation:fadeInModalBg .5s;}
        @keyframes fadeInModalBg{ from{ opacity: 0;}to{opacity:1;} }
        @keyframes modalAppear{ from{transform:scale(.83) translateY(60px);opacity:0;} to{transform:none;opacity:1;} }
        @keyframes fadeInTop{from{opacity:0;transform:translateY(-45px);}to{opacity:1;transform:none;} }
        @keyframes floatImg{to{transform: translateY(-14px) scale(1.015);} }
        @keyframes fadeInPulse{ 0%{ opacity:0; transform:scale(.8);} 70%{opacity:.54; transform: scale(1.03);} 100%{opacity:.73;transform:scale(1);} }
        .reveal { opacity:0; transform: translateY(36px) scale(0.98); transition:all 1s cubic-bezier(.7,0,.3,1);}
        .reveal.visible{ opacity:1;transform:none;}
        @media (prefers-reduced-motion: reduce) { * { transition: none !important; animation: none !important; } }
    </style>
</head>
<body data-theme="light">
<div class="loader-img">
    <svg width="140" height="44" viewBox="0 0 140 44" fill="none" xmlns="http://www.w3.org/2000/svg">
        <text x="0" y="34" font-family="Rubik, sans-serif" font-size="38" font-weight="900" fill="#00ffc2">
            Fit<tspan fill="#222">AI</tspan>
        </text>
    </svg>
</div>
<header class="navbar" id="navbar">
    <div class="logo">
        <span>FitAI</span>
    </div>
    <button class="nav-toggle" id="navToggle" aria-label="Open menu"><i class="ri-menu-3-line"></i></button>
    <nav>
        <ul id="navMenu">
            <li><a href="index.html" class="active">Home</a></li>
            <li><a href="workout.html">Workout</a></li>
            <li><a href="diet.html">Diet</a></li>
            <li><a href="about.html">About</a></li>
            <li id="accountNav"><a href="#" id="loginBtn">Login</a></li>
        </ul>
    </nav>
    <button id="themeToggle" class="theme-toggle" title="Toggle Theme"><i class="ri-moon-fill"></i></button>
</header>
<section class="hero reveal">
    <div class="hero-content">
        <h1>Unlock Your Best Self<br>with <span>FitAI</span>.</h1>
        <p>Smarter, science-backed workouts & diet guidance made for your body and goals. Reimagine your fitness journey with AI.</p>
        <a href="workout.html" class="btn">Get Started</a>
    </div>
    <div class="hero-img">
        <span class="img-bg-blob"></span>
        <img src="istockphoto-2155450527-612x612.jpg" alt="Active People" style="box-shadow:0 8px 48px #00ffc215;border-radius:21px;">
    </div>
</section>
<section class="features reveal">
    <div class="feature">
        <img src="aipow.png" alt="AI" />
        <h3>Personal AI Coach</h3>
        <p>Adaptive plans & smart tips that evolve with your body, mood, and results.</p>
    </div>
    <div class="feature">
        <img src="istockphotodiet.jpg" alt="Diet" />
        <h3>Dynamic Diet Builder</h3>
        <p>Vibrant meals for any goal, cuisine, budget, and even your macros and allergies.</p>
    </div>
    <div class="feature">
        <img src="weight-loss-exercise-plan.jpg" alt="Workout" />
        <h3>Custom Workouts</h3>
        <p>Top-tier routines by sport scientists: weight loss, muscle, HIIT, home, anywhere!</p>
    </div>
</section>
<footer>
    <p>&copy; 2025 FitAI &mdash; Your ultimate AI fitness sidekick</p>
</footer>

<div id="loginModal" class="modal">
    <div class="modal-content">
        <span class="close" id="closeModal">&times;</span>
        <h2>Sign in to FitAI</h2>
        <form id="loginForm">
            <input id="loginUsername" autocomplete="username" type="text" placeholder="Email" required />
            <div class="password-wrapper">
                <input id="loginPassword" autocomplete="current-password" type="password" placeholder="Password" required />
                <span class="toggle-eye" id="togglePassword"><i class="ri-eye-line"></i></span>
            </div>
            <button type="submit" class="btn">Login</button>
            <p class="small-text">Donâ€™t have an account? <a href="#" id="openSignup">Sign up</a></p>
        </form>
    </div>
</div>

<div id="signupModal" class="modal">
  <div class="modal-content">
    <span class="close" id="closeSignup">&times;</span>
    <h2>Create your FitAI Account</h2>
    <form id="signupForm">
      <input id="firstName" type="text" placeholder="First name" required />
      <input id="lastName" type="text" placeholder="Last name" required />
      <input id="signupEmail" type="email" placeholder="Email" required />
      <div class="password-wrapper">
        <input id="signupPassword" type="password" placeholder="Create password" required />
        <span class="toggle-eye" id="toggleSignupPw"><i class="ri-eye-line"></i></span>
      </div>
      <div class="password-wrapper">
        <input id="signupPassword2" type="password" placeholder="Confirm password" required />
        <span class="toggle-eye" id="toggleSignupPw2"><i class="ri-eye-line"></i></span>
      </div>
      <button type="submit" class="btn">Sign Up</button>
      <p class="small-text">Already have an account? <a href="#" id="openLogin">Login</a></p>
    </form>
  </div>
</div>

<div id="profileModal" class="modal">
  <div class="modal-content" style="max-width:420px;">
    <span class="close" id="closeProfile">&times;</span>
    <h2>Your Profile</h2>
    <div id="profileInfo" style="width:100%; margin-top:.5em; text-align:left;">
      </div>
    <div style="display:flex; gap:.8rem; width:100%; margin-top:1.1rem;">
      <button id="logoutBtn" class="btn" style="flex:1; background:#ff3b30;">Logout</button>
      <button id="closeProfileBtn" class="btn" style="flex:1;">Close</button>
    </div>
  </div>
</div>

<script>
    // Hamburger nav
    const navToggle = document.getElementById("navToggle");
    const navMenu = document.getElementById("navMenu");
    navToggle.onclick = () => navMenu.classList.toggle("open");

    // Modals
    const loginBtn = document.getElementById("loginBtn");
    const accountNav = document.getElementById("accountNav");
    const loginModal = document.getElementById("loginModal");
    const closeModal = document.getElementById("closeModal");

    const signupModal = document.getElementById("signupModal");
    const closeSignup = document.getElementById("closeSignup");
    const openSignup = document.getElementById("openSignup");
    const openLogin = document.getElementById("openLogin");

    const profileModal = document.getElementById("profileModal");
    const closeProfile = document.getElementById("closeProfile");
    const closeProfileBtn = document.getElementById("closeProfileBtn");
    const profileInfo = document.getElementById("profileInfo");
    const logoutBtn = document.getElementById("logoutBtn");

    // Open/close login modal
    loginBtn && (loginBtn.onclick = (e) => { e.preventDefault(); loginModal.classList.add("show"); });
    closeModal.onclick = () => loginModal.classList.remove("show");

    // Switch to signup
    if (openSignup) openSignup.onclick = (e) => { 
      e.preventDefault(); 
      loginModal.classList.remove("show"); 
      signupModal.classList.add("show"); 
    };
    if (openLogin) openLogin.onclick = (e) => { 
      e.preventDefault(); 
      signupModal.classList.remove("show"); 
      loginModal.classList.add("show"); 
    };

    // Close signup
    closeSignup.onclick = () => signupModal.classList.remove("show");

    // Close profile
    closeProfile.onclick = () => profileModal.classList.remove("show");
    closeProfileBtn.onclick = () => profileModal.classList.remove("show");

    // Close modals by clicking backdrop
    window.onclick = (e) => {
        if (e.target === loginModal) loginModal.classList.remove("show");
        if (e.target === signupModal) signupModal.classList.remove("show");
        if (e.target === profileModal) profileModal.classList.remove("show");
    };

    // Password eye toggles
    const pw = document.getElementById("loginPassword");
    const tgl = document.getElementById("togglePassword");
    tgl.onclick = () => {
        pw.type = pw.type === "password" ? "text":"password";
        tgl.innerHTML = pw.type==="password" ? '<i class="ri-eye-line"></i>' : '<i class="ri-eye-off-line"></i>';
    };
    const spw = document.getElementById("signupPassword");
    const spw2 = document.getElementById("signupPassword2");
    const tglS = document.getElementById("toggleSignupPw");
    const tglS2 = document.getElementById("toggleSignupPw2");
    tglS.onclick = () => {
        spw.type = spw.type === "password" ? "text":"password";
        tglS.innerHTML = spw.type==="password" ? '<i class="ri-eye-line"></i>' : '<i class="ri-eye-off-line"></i>';
    };
    tglS2.onclick = () => {
        spw2.type = spw2.type === "password" ? "text":"password";
        tglS2.innerHTML = spw2.type==="password" ? '<i class="ri-eye-line"></i>' : '<i class="ri-eye-off-line"></i>';
    };

    // Theme toggling
    const themeToggle = document.getElementById("themeToggle");
    const body = document.body;
    const moon = '<i class="ri-moon-fill"></i>'; 
    const sun = '<i class="ri-sun-fill"></i>';
    let mode = localStorage.getItem("theme") || "light";
    if(mode !== body.getAttribute("data-theme")) {
        body.setAttribute("data-theme", mode);
        themeToggle.innerHTML = mode==="dark"?sun:moon;
    }
    themeToggle.onclick = () => {
        const t = body.getAttribute("data-theme") === "dark" ? "light" : "dark";
        body.setAttribute("data-theme", t);
        localStorage.setItem("theme", t);
        themeToggle.innerHTML = t==="dark"?sun:moon;
    };

    // Loader fade-out
    window.addEventListener("load", ()=>{ document.querySelector(".loader-img")?.style.setProperty("display","none"); });

    // Section scroll-reveal
    function inView(el) { return el.getBoundingClientRect().top < window.innerHeight * .92; }
    function revealSections() { document.querySelectorAll(".reveal").forEach(el=>{ if (inView(el)) el.classList.add("visible"); }); }
    window.addEventListener("scroll",revealSections); window.addEventListener("load",revealSections);

    // 3D Feature Card Mouse-Tilt
    document.querySelectorAll('.feature').forEach(card => {
      card.addEventListener('mousemove', e => {
        const rect = card.getBoundingClientRect();
        const x = (e.clientX - rect.left) / rect.width - 0.5;
        const y = (e.clientY - rect.top) / rect.height - 0.5;
        card.style.transform = `rotateY(${x*16}deg) rotateX(${-y*10}deg) scale(1.06)`;
      });
      card.addEventListener('mouseleave', () => { card.style.transform = ''; });
    });

    // Button Ripple
    document.querySelectorAll('.btn').forEach(button => {
        button.addEventListener('click', function(e) {
            const circle = document.createElement('span');
            const diameter = Math.max(this.clientWidth, this.clientHeight);
            const radius = diameter / 2;
            circle.style.width = circle.style.height = `${diameter}px`;
            circle.style.left = `${e.clientX - this.offsetLeft - radius}px`;
            circle.style.top = `${e.clientY - this.offsetTop - radius}px`;
            circle.classList.add('ripple');
            this.appendChild(circle);
            circle.addEventListener('animationend', () => { circle.remove(); });
        });
    });

    // ---------- AUTH WIRING ----------
    // Replace Login with "Hi, {username}" if already logged in
    function renderAccountNavFromStorage() {
      const saved = JSON.parse(localStorage.getItem("fitai_user") || "null");
      if (saved && saved.username) {
        accountNav.innerHTML = `<a href="#" id="profileTrigger">Hi, ${saved.username}</a>`;
        const trigger = document.getElementById("profileTrigger");
        trigger.onclick = (e)=>{ e.preventDefault(); openProfileModal(); };
      } else {
        accountNav.innerHTML = `<a href="#" id="loginBtn">Login</a>`;
        document.getElementById("loginBtn").onclick = (e)=>{ e.preventDefault(); loginModal.classList.add("show"); };
      }
    }
    renderAccountNavFromStorage();

    // Login
    const loginForm = document.getElementById("loginForm");
    loginForm.onsubmit = async (e)=>{
        e.preventDefault();
        const payload = {
            email: document.getElementById("loginUsername").value.trim(),
            password: document.getElementById("loginPassword").value
        };
        try {
            const res = await fetch('http://localhost:5000/api/login', {
                method: 'POST',
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify(payload)
            });
            const data = await res.json();
            if (res.ok) {
                // save to localStorage
                const username = data.username || payload.email.split("@")[0];
                localStorage.setItem("fitai_user", JSON.stringify({ 
                  username, 
                  email: payload.email 
                }));
                loginModal.classList.remove("show");
                renderAccountNavFromStorage();
                alert("Login successful!");
            } else {
                alert("Login failed: " + (data.error || "Invalid credentials"));
            }
        } catch (err) {
            alert("Could not reach server.");
        }
    };

    // Signup
    const signupForm = document.getElementById("signupForm");
    signupForm.onsubmit = async (e)=>{
      e.preventDefault();
      const first = document.getElementById("firstName").value.trim();
      const last = document.getElementById("lastName").value.trim();
      const email = document.getElementById("signupEmail").value.trim();
      const pass = document.getElementById("signupPassword").value;
      const pass2 = document.getElementById("signupPassword2").value;

      if (pass.length < 6 || !/[!@#$%^&*._-]/.test(pass)) {
        alert("Password must be 6+ chars and include a special character.");
        return;
      }
      if (pass !== pass2) {
        alert("Passwords do not match.");
        return;
      }
      const username = `${first} ${last}`.trim();

      try {
        const res = await fetch('http://localhost:5000/api/signup', {
          method: 'POST',
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ username, email, password: pass })
        });
        const data = await res.json();
        if (res.ok) {
          signupModal.classList.remove("show");
          // auto-login UI (store locally) so user sees profile immediately
          localStorage.setItem("fitai_user", JSON.stringify({ username, email }));
          renderAccountNavFromStorage();
          alert("Signup successful â€” you are now logged in!");
        } else {
          alert("Signup failed: " + (data.error || "Please try again."));
        }
      } catch (err) {
        alert("Could not connect to server for signup.");
      }
    };

    // Profile modal UI
    function openProfileModal() {
      const saved = JSON.parse(localStorage.getItem("fitai_user") || "null");
      if (!saved) return;
      profileInfo.innerHTML = `
        <div style="line-height:1.9;">
          <div><b>Name:</b> ${saved.username}</div>
          <div><b>Email:</b> ${saved.email || "-"}</div>
        </div>
      `;
      profileModal.classList.add("show");
    }
    logoutBtn.onclick = () => {
      localStorage.removeItem("fitai_user");
      profileModal.classList.remove("show");
      renderAccountNavFromStorage();
      alert("Logged out successfully!");
    };

    // Navbar Scroll Effect
    const navbar = document.getElementById("navbar");
    window.addEventListener("scroll", () => {
        if (window.scrollY > 50) navbar.classList.add("scrolled");
        else navbar.classList.remove("scrolled");
    });
</script>
</body>
</html>